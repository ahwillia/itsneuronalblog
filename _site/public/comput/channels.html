<html>
 	<head>
 		<title>Channels, Synapses, Spikes - Introduction</title>
	  	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	  	<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>

		<script type="text/x-mathjax-config">
			MathJax.Hub.Config({
				"HTML-CSS": {
					preferredFont: "STIX",
					availableFonts: ["STIX"],
					webFont: "STIX-Web"
				},
				SVG: {
					font: "STIX-Web",
					blacker: 20
				},
				TeX: {
					equationNumbers: { autoNumber: "AMS" },
					extensions: ["extpfeil.js"]
				}
			});
		</script>

		<script type="text/x-mathjax-config">
		    MathJax.Hub.Config(
		    	{
		        	displayAlign: "center"
		       	}
		        );
		</script>

		<script type="text/javascript"
		   src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG">
		</script>
		\(\Newextarrow{\doubleharpoon}{5,10}{0x21CC}\)

		<link href='//fonts.googleapis.com/css?family=Lato:400,700' rel='stylesheet' type='text/css'>
		<link href='//fonts.googleapis.com/css?family=Vollkorn:400italic,400' rel='stylesheet' type='text/css'>

		<link rel="stylesheet" type="text/css" href="/textbook_style.css">

 	<link rel="icon" type="" href="favicon.ico"></head>

  <body>
  	<div class="title">
  		<table width="900">
  			<tr>
	  			<td width="90%">
				  	<div class="bigheader" id="titleinfo">
				 	</div>
			 	</td>
			 </tr>
			 <tr>
			 	<td width="70%">
			 		<br/>
			 		<div id="menu" class="menu" style="margin-left: 45; ">
			 			<table> <tr id="menurow"> </tr> </table>
			 		</div>
			 	</td>
		 	</tr>
	 	</table>
  	</div>

  		<table class="figureTable">
			<tr>
				<td style="vertical-align: top;">
					 <div class="text" style="margin-left: 0; margin-top:40px; color:red">
				 		<b><i>NOTE</i></b>: This book is still in the process of being written and revised. I've put this online because my incomplete draft may still be useful to some readers, but be aware that this is far from a finished project. You can help me finish faster by contributing material. I will give you fair credit!
					</div>
				</td>
				<td class="figureExplanation" style="color: #666">

				</td>
			</tr>
		</table>


		<div class="littleheader"> CHANNEL GATING 
			<div class="subheader" style="font-size: 14px"> FROM STOCHASTIC GATING TO DETERMINISTIC BEHAVIOR</div>
		</div>


		<table class="figureTable">
			<tr>
				<td style="vertical-align: top;">
				 <div class="text" style="margin-left: 0">

					<p>
					The take-home message of the previous section on chemical kinetics was that the following reaction,
					
					\begin{equation}
					X \overset{k}{\rightarrow} \varnothing
					\end{equation}
					
					can be modeled by following differential equation:
					
					\begin{equation}
					\frac{d[X]}{dt} = -k[X]
					\end{equation}

					The constant \(k\) is called a <b>rate constant</b>.<sup>1,2</sup> This simple (but not uninteresting!) case will help us explain more complicated chemical reactions that are more relevant to neural modeling.
					</p>

					<p>
					We will start with a simple model of a channel that has a single <a href="http://en.wikipedia.org/wiki/Gating_%28electrophysiology%29" target="_blank"><i>voltage-senstive gate</i></a> that switches between two states, <i>closed</i> (\(C\)) and open (\(O\)), with rate constants \(\alpha(V)\) and \(\beta(V)\). Because the channel is voltage-dependent, \(\alpha\) and \(\beta\) are modeled as functions of the membrane potential, \(V\). <sup>3</sup> We model this with the following kinetic reaction scheme:

					\begin{equation}
					C \doubleharpoon[\boldsymbol{\beta}\mathbf{(V)}]{\boldsymbol{\alpha}\mathbf{(V)}} O
					\end{equation}

					For now, let's assume that the membrane potential is held fixed (i.e. we are in a <a href="http://en.wikipedia.org/wiki/Voltage_clamp" target="_blank"><i>voltage-clamp experiment</i></a>).
					</p>

					<table style="margin-left:20px;" cellspacing="20px">
				  		<tr>
				  			<td>
							  	<img src="/public/comput/img/patch.png" width=300>
							</td>
							<td>
								<img src="/public/comput/img/patch.png" width=300>
							</td>
						</tr>
						<tr class="figureCaption">
							<td width=300>
								<b>Figure 1.</b> Single channel current recordings, measured in voltage-clamp from a frog muscle fibre. The membrane potential (mV) is indicated to the left of each trace.  <a href="http://www.ncbi.nlm.nih.gov/pubmed/6270629" target="_blank">(Hamill et al., 1981)</a>.
							</td>
							<td width=300>
								<b>Figure 2.</b> Simulation of a 
							</td>
						</tr>
					</table>

					

				<td class="figureExplanation" style="color: #666">
					<b>1.</b>
						<a href="http://en.wikipedia.org/wiki/Reaction_rate_constant" target="_blank"><b>Reaction Rate Constant</b></a>: A parameter that multiplicatively scales the rate of a chemical reaction.<br/><br/>
					<b>2.</b>
						A subtle, but important, detail is that the rate constant typically depends on temperature or other environmental variables. That is, the rate constant <b><i>is not actually a constant</i></b>.<br/><br/>
					<b>3.</b>
						For most channels, \(\alpha\) increases as \(V\) increases, while \(\beta\) decreases as \(V\) increases (channels open as the cell depolarizes). If you want to sound fancy, tell your friends that \(\alpha\) is a <a href="http://mathworld.wolfram.com/MonotonicFunction.html" target="_blank"><b>monotonically increasing</b></a> function of \(V\). <br/><br/>
				</td>
			</tr>
		</table>

		<div class="littleheader"> MODELING PROTEIN DEGRADATION 
			<div class="subheader" style="font-size: 14px"> EXPONENTIAL DECAY IN THE LIMIT OF MANY PROTEIN COPIES</div>
		</div>


		<table class="figureTable">
			<tr>
				<td style="vertical-align: top;">
					 <div class="text" style="margin-left: 0">

					 	<p>
					 	Let's start off with something simple. Suppose we have a single copy of a protein.<sup>3</sup> I'll call it protein \(X\) for generality. Suppose that over the course of one second, \(X\) will degrade with some probability \(q\). Furthermore, we will assume that the probability of degrading does not change over time. Another way of saying this is that the system is <i>memoryless</i>:<sup>4</sup> the probability that \(X\) will degrade in a given time interval does not depend on anything other than the length of the time interval. That is, if I observe that \(X\) has not degraded over the past 500 seconds, the probability that it will degrade in the next second is still \(q\) (and always will be, no matter how long I wait). These assumptions define an <b><i>elementary chemical reaction</i></b>,<sup>5</sup> which can be specified by the following notation:

						\begin{equation*}
						X \rightarrow \varnothing.
						\end{equation*}
						
						The above notation states that the protein is switching from one state (existent, \(X\)) to another (non-existent, \(\varnothing\)). The animation below schematically shows a protein (black dot) inside a "cell" (a blue circle). The protein floats around in a random fashion before "degrading" (when it disappears). This simulation is obviously not drawn to scale, but it gives you a sense of decay in a "memoryless" system. I have set \(q=0.5\) in this simulation. Thus, if you keep track of the outcome, you should be able to convince yourself that the protein degrades within 1 second half of the time, and degrades after 1 second the other half of the time. If you are really persistent, you will see that the protein degrades between 0 and 1 seconds on 1/2 of the trials, between 1 and 2 seconds on 1/4 of the trials, and over 2 seconds on the remaining 1/4 of the trials. This is exactly how a memoryless system behaves:
					 	</p>

					 	<table>
						 	<tr class="figureCaption">
								<td width="50%">
								<b>Figure 1.</b>&nbsp; Simulation of memoryless decay of a single protein.
								</td>
							</tr>
							<tr>
								<td>
								<div id="animatedWrapper" class="animation" style="position: relative;">
								<svg id="single_protein_degration_svg" class="svgWithText" width="740" height="300" style="margin-left:100px"></svg>
					 			<script type="text/javascript" src="/public/comput/js/Ch1/single_protein_degradation.js"></script>
	  							</div>
	  							</td>
							</tr>
						</table>

					 	
					</div>
				</td>
				<td class="figureExplanation" style="color: #666">
				<b>3.</b>
						There is nothing special about this example being a protein. It could just as easily be an mRNA molecule, or an atom undergoing radioactive decay.<br/><br/>
				<b>4.</b>
						Flipping a coin is another example of a memoryless event. If you flip 5 heads in a row, the probability of flipping tails on the next trial is still 50%. Memorylessness is also used to describe <a href="http://en.wikipedia.org/wiki/Markov_process" target="_blank">Markov processes</a>.<br/><br/>
				<b>5.</b>
						Elementary Chemical Reaction: a reaction in which the reactants directly form products in a single reaction step and with a single transition state.<br/><br/>
				</td>
			</tr>
		</table>

		<table class="figureTable">
			<tr>
				<td style="vertical-align: top;">
					 <div class="text" style="margin-left: 0">

					 	<p>
					 	Now the million-dollar question: suppose we observe that \(X\) is intact at some time point (\(t=0\)), and then check to see whether it has been degraded (converted to \(\varnothing\)) at some future time point. Let \(P_x(t)\) be the <strong><em>survival probability</em></strong> of \(X\) at time \(t\); that is, the probability that \(X\) is not degraded when we check \(t\) seconds into the future. We are told that the probability of degrading in the first second equals \(q\). The survival probability for the first second is therefore \(P_x(1) = 1-q\). Whether or not \(X\) degrades in the next second, from \(t=1\) to \(t=2\), can be considered an independent event because the degradation is memoryless. Because independent probabilities can be multiplied to find the probability of their intersection, the survival probability for two seconds is given by:

					    \begin{equation*}
					    P_x(2) = P_x(1) \times P_x(1) = (1-q)^2.
					    \end{equation*}

					    We can extrapolate this logic to derive the survival probability of \(X\) over time. A detailed derivation is provided in <a href="/comput/Ch1/exercises.html#e1">Exercise #1</a> in this chapter. The solution to this exercise shows that we ultimately arrive at the exponential probability distribution:

					    \begin{equation}
					    P_x(t) = k~e^{-kt}~,
					    \end{equation}

					    where \(k = -\ln[1-q]\). The constant \(k\) is called the reaction <strong><em>rate constant</em></strong>.<sup>5</sup> The result given in equation (1) provides useful insight into the simultaneous degradation of many proteins.Below, I have reproduced the same animation as above, except I've increased the total number of protein copies from 1 to 250. I have again fixed \(q=0.5\). After each simulation, a histogram shows how many proteins degraded in each time bin. Note that the histogram can be approximated by a decaying, exponential curve. This approximation gets more and more precise as we increase the number of protein copies.
					    </p>

					    <table>
						 	<tr class="figureCaption">
								<td width="100%">
								<b>Figure 2.</b>&nbsp; 250 proteins undergoing memoryless decay. The number of decay events in each time bin follows an exponential curve.
								</td>
							</tr>
							<tr>
								<td>
								<div id="animatedWrapper" class="animation" style="position: relative;">
								<svg id="many_protein_degration_svg" class="svgWithText" width="800" height="300"></svg>
					 			<script type="text/javascript" src="/public/comput/js/Ch1/many_protein_degradation.js"></script>
	  							</div>
	  							</td>
							</tr>
						</table>

					</div>
				</td>
				<td class="figureExplanation" style="color: #666">
				<b>6.</b>
						The rate constant is sometimes denoted as \(\lambda\) in other texts, particularly in the context of radioactive decay. Another common measure of decay rate is the <a href="http://en.wikipedia.org/wiki/Half-life" target="_blank">half-life</a>, \(t_{1/2}\), which is directly related to the rate constant: \(t_{1/2} = \ln [2] / k\)
				</td>
			</tr>
		</table>


		<table class="figureTable">
			<tr>
				<td style="vertical-align: top;">
					 <div class="text" style="margin-left: 0">
					 	<p>
					 	While simulations in Figure 1 are highly probabilistic, the above simulations are more consistent from trial to trial simply because we have more protein copies. In the limit where we have infinitely many protein copies, the system is entirely deterministic (see <a href="http://en.wikipedia.org/wiki/Law_of_large_numbers">Law of Large Numbers</a> and <a href="http://en.wikipedia.org/wiki/Frequentist_probability">Frequentist probability</a>). Similarly, we expect to get roughly 50% heads and 50% tails when we flip a coin a million times, but we are much more uncertain about the proportion of heads to tails when flipping a coin only 10 times. For the next few chapters, we will primarily be concerned with systems that have many protein copies, and therefore behave more or less deterministically.
					    </p>

					    <p>
					    In the limit of having many proteins, we can model changes in protein concentration rather than protein number. We denote the concentration of \(X\) at time \(t\) with square brackets, \([X](t)\).  This is important, because concentration is a <i>continuous</i> variable, while the number of protein copies is <i>discrete</i>.<sup>7</sup> The concentration is an exponentially decaying function of time:<sup>8</sup>
							\begin{equation}
							[X](t) = [X]_0~e^{-kt},
							\end{equation}
						Where \([X]_0\) is the initial concentration of \(X\) at time \(t=0\). This can be easily verified:
							\begin{equation*}
							[X](t=0) = [X]_0~e^{0} = [X]_0
							\end{equation*}

					    <i>We now make a fundamental insight:</i> take the derivative of \([X]\) with respect to time. If we remember that the <a target="_blank" href="https://www.youtube.com/watch?v=OjnOgoEu6CM">derivative	of an exponential</a> is another exponential and apply the <a target="_blank" href="https://www.khanacademy.org/math/differential-calculus/taking-derivatives/chain_rule/v/chain-rule-introduction">chain rule</a>, we get:
							\begin{equation*}
							\frac{d[X]}{dt} = \frac{d}{dt}\left( [X]_0e^{-kt}\right) \\
							\frac{d[X]}{dt} = -k[X]_0e^{-kt} \\
							\end{equation*}
						We then substitute \([X]_0~e^{-kt} = [X](t)\) (equation 2) into the right hand side of this equation:
							\begin{equation}
							\frac{d[X]}{dt} = -k[X]
							\end{equation}
						Are you on the edge of your seat by now? The above equation shows that <i>the rate of protein degradation is simply inversely proportional to protein concentration</i>! This is illustrated in the figure below.
						</p>

						<table>
						 	<tr class="figureCaption">
								<td width="100%">
								<b>Figure 3.</b>&nbsp; decay rate (blue slope) is proportional to \([X]\).
								</td>
							</tr>
							<tr>
								<td>
								<div id="animatedWrapper" class="animation" style="position: relative;">
									<div class="controls">
										<br><label for=rateConstFader style="font-weight:bold">Rate Constant</label><br>
										<input type=range min=0.5 max=3.0 value=1.0 id=rateConstFader step=0.1 oninput="updateRateConst(value);" style="width:50%">
									</div>
									<script>
										var RATE_CONST = 1.0;
										function updateRateConst(k){ RATE_CONST = k; }
									</script>

									<svg id="exp_deriv_svg" class="svgWithText" width="700" height="300"></svg>
						 			<script type="text/javascript" src="/public/comput/js/Ch1/exp_derivative.js"></script>
	  							</div>
	  							</td>
							</tr>
						</table>

						<p>
						This result stated in equation 3 is exciting because we have developed a concise mathematical representation (a <b><i>differential equation</i></b>) to model an elementary chemical reaction. We will soon see that this allows us to combine a series of elementary reactions into a system of coupled differential equations to model complex chemical signaling pathways.
						</p>

					</div>
				</td>
				<td class="figureExplanation" style="color: #666">
				<b>7.</b>
						A <i>discrete variable</i> can take on a finite or countably infinite set of values (e.g. number of proteins can be any positive integer). A <i>continuous variable</i> can take on any values within an interval of real numbers (e.g. concentration can be any positive real number).<br/><br/>
				<b>8.</b>
						This is because concentration is simply <a href="http://en.wikipedia.org/wiki/Proportionality_%28mathematics%29" target="_blank"><b>proportional</b></a> to the number of proteins.
				</td>
			</tr>
		</table>

		</p>
		<br/><br/>
	<div class="title" id=""><div class="footerbutton" style=""><a href="empty.html">NEXT <span style="font-size: 12px">▶</span></a></div></div>
	<script type="text/javascript" src="/public/comput/menu.js"></script></body>
</html>